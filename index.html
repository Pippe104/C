<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flowers</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: radial-gradient(circle at center, #1a2a35, #0a1419);
    font-family: 'Arial', sans-serif;
}

canvas {
    position: absolute;
    top: 0;
    left: 0;
    display: block;
}

.overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    z-index: 20;
    width: 100%;
    pointer-events: none;
}

.valentine-message {
    color: white;
    font-size: 3.5rem;
    font-weight: bold;
    text-shadow: 0 0 40px rgba(255, 120, 120, 0.8), 0 0 20px rgba(255, 100, 100, 0.6);
    margin-bottom: 2rem;
    letter-spacing: 6px;
    animation: pulse 2s infinite;
    pointer-events: none;
    font-family: 'Georgia', serif;
}

@keyframes pulse {
    0% { text-shadow: 0 0 40px rgba(255, 120, 120, 0.8), 0 0 20px rgba(255, 100, 100, 0.6); }
    50% { text-shadow: 0 0 60px rgba(255, 150, 150, 1), 0 0 30px rgba(255, 120, 120, 0.9); }
    100% { text-shadow: 0 0 40px rgba(255, 120, 120, 0.8), 0 0 20px rgba(255, 100, 100, 0.6); }
}

.buttons-container {
    display: flex;
    gap: 3rem;
    justify-content: center;
    align-items: center;
    pointer-events: auto;
    position: relative;
    margin-top: 2rem;
}

.btn {
    padding: 1rem 2.5rem;
    font-size: 1.5rem;
    font-weight: bold;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    letter-spacing: 2px;
}

.btn-yes {
    background: linear-gradient(45deg, #ff4d4d, #ff1a1a);
    color: white;
    border: 2px solid #fff;
    transform-origin: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    z-index: 30;
}

.btn-yes:hover {
    box-shadow: 0 0 30px rgba(255, 77, 77, 0.6);
}

.btn-no {
    background: linear-gradient(45deg, #666, #444);
    color: white;
    border: 2px solid #ccc;
    position: relative;
    transition: all 0.2s ease;
    cursor: pointer;
    z-index: 40;
}

.btn-no:hover {
    background: linear-gradient(45deg, #777, #555);
}

.success-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255, 255, 255, 0.95);
    color: #ff1a1a;
    padding: 3rem 5rem;
    border-radius: 20px;
    font-size: 3rem;
    font-weight: bold;
    z-index: 100;
    box-shadow: 0 0 100px rgba(255, 77, 77, 0.5);
    animation: popIn 0.5s ease;
    border: 3px solid #ff4d4d;
    text-align: center;
    pointer-events: none;
}

@keyframes popIn {
    0% { transform: translate(-50%, -50%) scale(0); }
    80% { transform: translate(-50%, -50%) scale(1.1); }
    100% { transform: translate(-50%, -50%) scale(1); }
}

.heart {
    color: #ff1a1a;
    font-size: 5rem;
    margin-bottom: 1rem;
}
</style>
</head>

<body>

<canvas id="canvas"></canvas>

<div class="overlay">
    <div class="valentine-message">CC will u be my valentine?</div>
    
    <div class="buttons-container">
        <button class="btn btn-yes" id="yesBtn">Sì ❤️</button>
        <button class="btn btn-no" id="noBtn">No</button>
    </div>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

/* ---------------- PETALI CADENTI ---------------- */

class Petalo {
    constructor(isHeart = false) {
        this.isHeart = isHeart;
        this.reset();
    }

    reset() {
        this.x = Math.random() * canvas.width;
        this.y = -20;
        this.vy = 0.8 + Math.random() * 2;
        this.vx = -0.6 + Math.random() * 1.2;
        this.size = 6 + Math.random() * 14;
        this.alpha = 0.5 + Math.random() * 0.4;
        this.rotation = Math.random() * Math.PI * 2;
        this.rotationSpeed = (Math.random() - 0.5) * 0.02;
        
        if (this.isHeart) {
            const colors = ["#ff4d4d", "#ff1a1a", "#ff6666", "#ff9999", "#ff3333"];
            this.color = colors[Math.floor(Math.random() * colors.length)];
        } else {
            const colors = [
                "#ffb7c5", "#ff9eb5", "#ffa8b5", "#ffb3ba", "#ffc0cb",
                "#fdd0e4", "#ffe0f0", "#ffe4e1", "#fff0f5", "#ffe6f0"
            ];
            this.color = colors[Math.floor(Math.random() * colors.length)];
        }
        this.secondColor = "#fff0f5";
    }

    update() {
        this.x += this.vx;
        this.y += this.vy;
        this.rotation += this.rotationSpeed;
        
        this.vx += (Math.random() - 0.5) * 0.03;
        this.vy += 0.005;

        if (this.y > canvas.height + 30 || 
            this.x < -30 || 
            this.x > canvas.width + 30) {
            this.reset();
        }
    }

    draw() {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.rotation);
        ctx.globalAlpha = this.alpha;
        
        ctx.shadowColor = "rgba(0, 0, 0, 0.2)";
        ctx.shadowBlur = 5;
        ctx.shadowOffsetX = 1;
        ctx.shadowOffsetY = 1;

        if (this.isHeart) {
            // Disegna un cuore
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.moveTo(0, 0);
            ctx.bezierCurveTo(-this.size/2, -this.size/2, -this.size, this.size/3, 0, this.size);
            ctx.bezierCurveTo(this.size, this.size/3, this.size/2, -this.size/2, 0, 0);
            ctx.fill();
        } else {
            // Disegna un petalo
            const gradient = ctx.createLinearGradient(-this.size, 0, this.size, 0);
            gradient.addColorStop(0, this.color);
            gradient.addColorStop(1, this.secondColor);
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.ellipse(0, 0, this.size, this.size * 0.5, 0, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.globalAlpha = this.alpha * 0.3;
            ctx.strokeStyle = "#ff8da1";
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(-this.size * 0.8, 0);
            ctx.lineTo(this.size * 0.8, 0);
            ctx.stroke();
        }

        ctx.restore();
    }
}

/* ---------------- FIORI SFONDO ---------------- */

class Flower {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.radius = 30 + Math.random() * 50;
        this.petalCount = 5 + Math.floor(Math.random() * 5);
        this.petalLayers = Math.random() > 0.6 ? 2 : 1;
        this.alpha = 0.15 + Math.random() * 0.1;
        this.rotation = Math.random() * Math.PI * 2;
        this.rotationSpeed = (Math.random() - 0.5) * 0.0008;
        
        const palettes = [
            { petal: ["#fce4e8", "#f8bbd0", "#f48fb1"], center: ["#ffecb3", "#ffe082", "#ffd54f"] },
            { petal: ["#e8eaf6", "#c5cae9", "#9fa8da"], center: ["#fff9c4", "#fff59d", "#fff176"] },
            { petal: ["#fff3e0", "#ffe0b2", "#ffcc80"], center: ["#ffe0b2", "#ffb74d", "#ff9800"] },
            { petal: ["#e0f2f1", "#b2dfdb", "#80cbc4"], center: ["#fdd835", "#ffb300", "#ff6f00"] },
            { petal: ["#f3e5f5", "#e1bee7", "#ce93d8"], center: ["#fff9c4", "#fff59d", "#fff176"] },
            { petal: ["#ffebee", "#ffcdd2", "#ef9a9a"], center: ["#ffecb3", "#ffe082", "#ffd54f"] }
        ];

        this.palette = palettes[Math.floor(Math.random() * palettes.length)];
        
        this.hasBud = Math.random() > 0.7;
        if (this.hasBud) {
            this.budX = -this.radius * 0.8;
            this.budY = -this.radius * 0.6;
            this.budSize = this.radius * 0.3;
        }
        
        this.hasStem = Math.random() > 0.5;
        if (this.hasStem) {
            this.stemLength = this.radius * 0.8;
            this.leafCount = 1 + Math.floor(Math.random() * 2);
        }
    }

    update() {
        this.rotation += this.rotationSpeed;
    }

    drawStem() {
        if (!this.hasStem) return;
        
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.globalAlpha = this.alpha * 0.8;
        
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(0, this.stemLength);
        ctx.strokeStyle = "#558b2f";
        ctx.lineWidth = 2;
        ctx.stroke();
        
        for (let i = 0; i < this.leafCount; i++) {
            const leafY = this.stemLength * (0.3 + i * 0.3);
            
            ctx.save();
            ctx.translate(0, leafY);
            ctx.rotate(0.3);
            ctx.fillStyle = "#7cb342";
            ctx.globalAlpha = this.alpha * 0.6;
            ctx.beginPath();
            ctx.ellipse(0, 0, this.radius * 0.15, this.radius * 0.1, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
            
            ctx.save();
            ctx.translate(0, leafY);
            ctx.rotate(-0.3);
            ctx.fillStyle = "#7cb342";
            ctx.globalAlpha = this.alpha * 0.6;
            ctx.beginPath();
            ctx.ellipse(0, 0, this.radius * 0.15, this.radius * 0.1, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        }
        
        ctx.restore();
    }

    drawBud() {
        if (!this.hasBud) return;
        
        ctx.save();
        ctx.translate(this.x + this.budX, this.y + this.budY);
        ctx.globalAlpha = this.alpha * 0.9;
        ctx.fillStyle = this.palette.petal[1];
        ctx.beginPath();
        ctx.ellipse(0, 0, this.budSize, this.budSize * 0.8, 0, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
    }

    drawPetal(x, y, radiusX, radiusY, rotation, color1, color2, alpha) {
        ctx.save();
        ctx.translate(x, y);
        ctx.rotate(rotation);
        ctx.globalAlpha = alpha;
        
        const gradient = ctx.createRadialGradient(
            radiusX * 0.5, 0, 2,
            radiusX * 0.5, 0, radiusX * 0.9
        );
        gradient.addColorStop(0, color1);
        gradient.addColorStop(0.7, color2);
        gradient.addColorStop(1, "rgba(255,255,255,0.1)");

        ctx.fillStyle = gradient;
        ctx.shadowColor = "rgba(0,0,0,0.1)";
        ctx.shadowBlur = 8;
        ctx.shadowOffsetX = 1;
        ctx.shadowOffsetY = 1;
        
        ctx.beginPath();
        ctx.ellipse(radiusX * 0.6, 0, radiusX, radiusY, 0, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.restore();
    }

    draw() {
        this.drawStem();
        
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.rotation);
        ctx.globalAlpha = this.alpha;
        
        for (let layer = 0; layer < this.petalLayers; layer++) {
            const layerRadius = this.radius * (1 - layer * 0.2);
            const layerAlpha = this.alpha * (1 - layer * 0.2);
            
            for (let i = 0; i < this.petalCount; i++) {
                const angle = (Math.PI * 2 * i) / this.petalCount + layer * 0.3;
                
                let petalColor1, petalColor2;
                if (layer === 0) {
                    petalColor1 = this.palette.petal[0];
                    petalColor2 = this.palette.petal[1];
                } else {
                    petalColor1 = this.palette.petal[1];
                    petalColor2 = this.palette.petal[2];
                }
                
                this.drawPetal(
                    Math.cos(angle) * layerRadius * 0.3,
                    Math.sin(angle) * layerRadius * 0.3,
                    layerRadius * 0.5,
                    layerRadius * 0.25,
                    angle,
                    petalColor1,
                    petalColor2,
                    layerAlpha
                );
            }
        }

        // Centro fiore
        ctx.globalAlpha = this.alpha + 0.1;
        const outerCenterGradient = ctx.createRadialGradient(0, 0, 1, 0, 0, this.radius * 0.3);
        outerCenterGradient.addColorStop(0, this.palette.center[0]);
        outerCenterGradient.addColorStop(1, this.palette.center[1]);
        
        ctx.fillStyle = outerCenterGradient;
        ctx.shadowBlur = 5;
        ctx.beginPath();
        ctx.arc(0, 0, this.radius * 0.25, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.globalAlpha = this.alpha + 0.2;
        const innerCenterGradient = ctx.createRadialGradient(-2, -2, 1, 0, 0, this.radius * 0.15);
        innerCenterGradient.addColorStop(0, this.palette.center[2] || "#ffd54f");
        innerCenterGradient.addColorStop(1, this.palette.center[1]);
        
        ctx.fillStyle = innerCenterGradient;
        ctx.shadowBlur = 8;
        ctx.beginPath();
        ctx.arc(0, 0, this.radius * 0.12, 0, Math.PI * 2);
        ctx.fill();
        
        // Pistilli
        ctx.globalAlpha = this.alpha + 0.3;
        ctx.fillStyle = "#b8860b";
        ctx.shadowBlur = 3;
        
        for (let i = 0; i < 8; i++) {
            const angle = (Math.PI * 2 * i) / 8;
            const x = Math.cos(angle) * this.radius * 0.18;
            const y = Math.sin(angle) * this.radius * 0.18;
            
            ctx.beginPath();
            ctx.arc(x, y, this.radius * 0.03, 0, Math.PI * 2);
            ctx.fill();
        }
        
        ctx.restore();
        this.drawBud();
    }
}

/* ---------------- CREAZIONE OGGETTI ---------------- */

let petals = [];
function initPetals() {
    petals = [];
    const petalCount = Math.min(150, Math.floor(window.innerWidth * 0.08));
    for (let i = 0; i < petalCount; i++) {
        petals.push(new Petalo(false));
    }
}

let flowers = [];
function initFlowers() {
    flowers = [];
    const flowerCount = Math.min(25, Math.floor(window.innerWidth * 0.015));
    const minDistance = 250;
    
    for (let i = 0; i < flowerCount; i++) {
        let placed = false;
        let attempts = 0;
        
        while (!placed && attempts < 1000) {
            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height;
            
            let tooClose = false;
            for (let f of flowers) {
                if (Math.hypot(f.x - x, f.y - y) < minDistance) {
                    tooClose = true;
                    break;
                }
            }
            
            if (!tooClose) {
                flowers.push(new Flower(x, y));
                placed = true;
            }
            attempts++;
        }
        
        if (!placed) {
            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height;
            flowers.push(new Flower(x, y));
        }
    }
}

initPetals();
initFlowers();

window.addEventListener("resize", () => {
    resizeCanvas();
    initPetals();
    initFlowers();
});

function startHearts() {
    // Aggiungi 50 cuori all'inizio
    for (let i = 0; i < 50; i++) {
        petals.push(new Petalo(true));
    }
    
    // Continua ad aggiungere cuori ogni 300ms
    const heartInterval = setInterval(() => {
        for (let i = 0; i < 3; i++) {
            petals.push(new Petalo(true));
        }
    }, 300);
    
    return heartInterval;
}

/* ---------------- ANIMAZIONE ---------------- */

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    ctx.shadowBlur = 0;
    ctx.shadowOffsetX = 0;
    ctx.shadowOffsetY = 0;

    for (let flower of flowers) {
        flower.update();
        flower.draw();
    }

    for (let petal of petals) {
        petal.update();
        petal.draw();
    }

    requestAnimationFrame(animate);
}

animate();

/* ---------------- INTERAZIONE BOTTONI ---------------- */

const yesBtn = document.getElementById('yesBtn');
const noBtn = document.getElementById('noBtn');
const overlay = document.querySelector('.overlay');

let yesSize = 1;
let noClicks = 0;
let heartInterval = null;

noBtn.addEventListener('click', function(e) {
    e.preventDefault();
    
    // Ottieni le dimensioni del bottone
    const btnWidth = this.offsetWidth;
    const btnHeight = this.offsetHeight;
    
    // Calcola i limiti per mantenere il bottone completamente dentro lo schermo
    const maxX = window.innerWidth - btnWidth - 20;  // 20px di margine dal bordo destro
    const minX = 20;  // 20px di margine dal bordo sinistro
    const maxY = window.innerHeight - btnHeight - 100; // 100px dal fondo per evitare overlay
    const minY = 80; // 80px dall'alto per evitare il titolo
    
    // Genera posizioni casuali ma sempre dentro i bordi
    const randomX = Math.floor(Math.random() * (maxX - minX + 1) + minX);
    const randomY = Math.floor(Math.random() * (maxY - minY + 1) + minY);
    
    // Applica la posizione
    this.style.position = 'fixed';
    this.style.left = randomX + 'px';
    this.style.top = randomY + 'px';
    this.style.transform = 'none';
    
    // Aumenta la dimensione del bottone Sì
    noClicks++;
    yesSize = 1 + (noClicks * 0.15);
    yesBtn.style.transform = `scale(${yesSize})`;
    yesBtn.style.fontSize = `${1.5 * yesSize}rem`;
    yesBtn.style.padding = `${1 * yesSize}rem ${2.5 * yesSize}rem`;
    
    // Cambia il testo del bottone No
    const noTexts = ['No', 'Sicura?', 'Davvero?', 'Pensa bene...', 'Non farlo!', 'Clicca Sì!', 'Forza!', 'Ti prego!', 'Per favore!', '❤️?'];
    this.textContent = noTexts[Math.min(noClicks - 1, noTexts.length - 1)];
});

yesBtn.addEventListener('click', function() {
    // Ferma eventuali interval precedenti
    if (heartInterval) {
        clearInterval(heartInterval);
    }
    
    // Rimuovi i bottoni e il messaggio
    document.querySelector('.buttons-container').style.display = 'none';
    document.querySelector('.valentine-message').style.display = 'none';
    
    // Crea messaggio di successo
    const successDiv = document.createElement('div');
    successDiv.className = 'success-message';
    successDiv.innerHTML = '<div class="heart">❤️</div>EVVIVA!<br><span style="font-size: 1.5rem; color: #666;">❤️Tvb tanto CC❤️</span>';
    document.body.appendChild(successDiv);
    
    // PARTONO I PETALI (CUORI)!
    heartInterval = startHearts();
    
    // Aggiungi anche tanti fiori rossi allo sfondo
    for (let i = 0; i < 10; i++) {
        setTimeout(() => {
            flowers.push(new Flower(
                Math.random() * canvas.width,
                Math.random() * canvas.height
            ));
        }, i * 100);
    }
});

</script>

</body>
</html>